# 基于神经网络的文本分类算法

[TOC]

## 1.文件介绍

create_data_start.py   文本处理方法

create_data_utils.py    文本处理工具

model.py  模型文件1

​	多模态学习文件，这是针对不规则数据集的处理方法。算法不是很完善，有待优化。

net.py    主要的模型文件

​	主要采用的是cnn，之前那个版本是bilstm现在换成了CNN。主要还是依靠大型稀疏矩阵进行学习。

read_config.py  读取配置文件

pre_create_data.py 数据预处理文件

​	主要包括的操作有 

​	1，单词分词，因为我发现数据集里面有部分单词分词效率过低。所以我对于此类单词，利用wordninja库进行了再一次分词，效果优于之前的文件。

​	2，单词纠正，因为文本中存在，因为的口语描述，比如u == you ，这类单词对于数据训练来说效果是非常差的，所以这些我利用了workcheck进行纠正，思路就是正则替换。其中wordcheck.txt是含有12w行《老友记》台词的数据集。（其实纠正效果还是不是很明显，但是相比之前已经好多了）

text_reader.py  数据集读取文件

trian.py  训练文件

utils.py   这个是之前版本的工具文件

valid_model_acc.py   模型准确率验证文件

valid.py   预测输出，并得到accuary文件

wordcheck.py  单词纠正算法文件

## 2.核心算法

### cnn算法

代码：

```python
import paddle.fluid as fluid

def cnn_net(data,label,dict_dim,emb_dim=128,hid_dim=128,hid_dim2=96,class_dim=10,
            win_size=3,is_infer=False):
    """
    Conv net
    """
    # embedding layer
    emb = fluid.layers.embedding(input=data, size=[dict_dim, emb_dim])
    # convolution layer
    conv_3 = fluid.nets.sequence_conv_pool(
        input=emb,
        num_filters=hid_dim,
        filter_size=win_size,
        act="tanh",
        pool_type="max")
    # full connect layer
    fc_1 = fluid.layers.fc(input=[conv_3], size=hid_dim2)
    # dropout layer
    dropout_1 = fluid.layers.dropout(x=fc_1,dropout_prob=0.5,name="dropout")
    # softmax layer
    prediction = fluid.layers.fc(input=[dropout_1], size=class_dim, act="softmax")
    return prediction
```

## 3.操作步骤

### 1.预处理数据

①：拆分单词

​	因为部分文档的单词标识度不是很高，所以我利用的wordninja框架进行再次分词。这样很明显一些单词被再次分割。比如2019years已经被分割成了2019 years。这样的效果比之前好很多了。只要我们人读起来就比较通顺了。

②：单词拼写纠正

​	因为数据集中是采集的是国外的社交网站发的贴子，说说之类，所以有很多的俚语和外国人说的话，会省略很多单词，或则和用其他的单词代替原有代词（读音相同）。比如：u == you ，c == say等。

③：操作方法

python  pre_create_data.py

④：代码

```python
 # 拆分单词
 data = wdja.split(data)
 data1 = []
 for data2 in data:
     # 单词拼写纠正
     data1.append(wordcheck.correct(data2))
 strs = " ".join(list(data1))
 x_train_list.append(strs)
 x_train_file.write(strs + "\n")
```

### 2.生成数据集

①：生成过程

​       生成数据字典 -> 根据测试集和验证集的单词，生成一个数据字典，大小根据内容的单词多少决定。文件名称：dict_txt_all.txt。

​       生成测试集合和训练集合 -> 文件名称：train_list_end.txt/valid_list_end.txt。

​       过程中使用了词干还原算法，将复数，动名词，完成时等进行了还原。WordNetLemmatizer 是用于取出停止词。

②：操作

​	先运行：python pre_create_data.py 生成 train.txt，valid.txt文件。

​	再次运行：python create_data_start.py  

​		选择 1 训练模式。

​		生成训练集合之后，选择1 继续生成，然后得到结果。

## 3.执行训练

①：使用GPU进行训练

为了提高计算速度所以我采用的是GPU进行运算和训练。

代码如下：

```python
#创建一个执行器
#1：CPU训练速度比较慢，故采用GPU进行训练
#2：为了保证acc，所以请使用GPU。
place = fluid.CUDAPlace(0)
```

②：输出模型

```python
    # 保存预测模型
    save_path = 'infer_model/'

    # 删除旧的模型文件
    shutil.rmtree(save_path, ignore_errors=True)

    # 创建保持模型文件目录
    os.makedirs(save_path)

    # 保存预测模型
    fluid.io.save_inference_model(save_path, feeded_var_names=[words.name], target_vars=[model], executor=exe)
```

模型名称为：infer_model

③：使用方式

​	在完成了1，2流程之后即可进行运行此代码

​	python train.py

## 4.执行预测

①：选择GPU进行预测输出

②：输出文件为result.txt

​	其中输出的结果里面就包含了acc。

## 5.框架安装方法

①：访问网站<http://paddlepaddle.org/paddle/GettingStarted>

②：选择如图

​	![教程一](.\img\教程一.png)

③：输出结果

**安装信息：**

```python
pip3 install paddlepaddle-gpu
```

**验证信息：**

使用 `python3` 进入python解释器，输入`import paddle.fluid` ，再输入 `paddle.fluid.install_check.run_check()`。
如果出现 `Your Paddle Fluid is installed succesfully!`，说明您已成功安装。

**说明信息：**

需要 python 版本高于 3.5.0 且 pip 版本高于 9.0.1。
更多帮助信息请参考 [Ubuntu 下使用 pip 安装](http://paddlepaddle.org/documentation/docs/zh/1.4/beginners_guide/install/install_Ubuntu.html)

注：`pip install paddlepaddle-gpu` 命令将安装支持CUDA 9.0 cuDNN v7的PaddlePaddle，如果您的CUDA或cuDNN版本与此不同，可以参考 [这里](https://pypi.org/project/paddlepaddle-gpu/#history) 了解其他CUDA/cuDNN版本所适用的安装命令

## 6.代码测试

环境：

| 显卡             | [NVIDIA Tesla V100](https://www.nvidia.cn/data-center/tesla-v100/) |
| ---------------- | ------------------------------------------------------------ |
| Cores            | 2                                                            |
| 内存             | 8GB Memory                                                   |
| 系统             | Ubuntu                                                       |
| 显存             | 16G                                                          |
| paddlepaddle版本 | 框架: PaddlePaddle 1.4.1 (Python 3.6)                        |

软件：Jupyter 笔记本

地址：[https://aistudio.baidu.com](https://aistudio.baidu.com/)

### 模型：infer_model

训练迭代日志输出：

```verilog
Pass:0, Batch:0, Cost:2.30027, Acc:0.10156
Test:0, Cost:2.26785, ACC:0.19443
Pass:0, Batch:40, Cost:2.00160, Acc:0.21094
Test:0, Cost:1.96510, ACC:0.26152
Pass:1, Batch:0, Cost:1.94542, Acc:0.44531
Test:1, Cost:1.95483, ACC:0.35104
Pass:1, Batch:40, Cost:1.78021, Acc:0.44531
Test:1, Cost:1.77840, ACC:0.40863
Pass:2, Batch:0, Cost:1.68884, Acc:0.55469
Test:2, Cost:1.76447, ACC:0.43449
Pass:2, Batch:40, Cost:1.55811, Acc:0.58594
Test:2, Cost:1.59984, ACC:0.48448
Pass:3, Batch:0, Cost:1.50054, Acc:0.62500
Test:3, Cost:1.58942, ACC:0.47548
Pass:3, Batch:40, Cost:1.39445, Acc:0.61719
Test:3, Cost:1.46806, ACC:0.51233
Pass:4, Batch:0, Cost:1.36574, Acc:0.60938
Test:4, Cost:1.45963, ACC:0.52233
Pass:4, Batch:40, Cost:1.13338, Acc:0.72656
Test:4, Cost:1.36950, ACC:0.56015
Pass:5, Batch:0, Cost:1.13022, Acc:0.69531
Test:5, Cost:1.36396, ACC:0.56405
Pass:5, Batch:40, Cost:1.07034, Acc:0.67969
Test:5, Cost:1.30199, ACC:0.58453
Pass:6, Batch:0, Cost:1.01823, Acc:0.73438
Test:6, Cost:1.29810, ACC:0.57989
Pass:6, Batch:40, Cost:1.02507, Acc:0.67969
Test:6, Cost:1.25205, ACC:0.58379
Pass:7, Batch:0, Cost:0.92054, Acc:0.76562
Test:7, Cost:1.24948, ACC:0.58575
Pass:7, Batch:40, Cost:1.03106, Acc:0.74219
Test:7, Cost:1.21637, ACC:0.59475
Pass:8, Batch:0, Cost:1.00770, Acc:0.75000
Test:8, Cost:1.21415, ACC:0.59182
Pass:8, Batch:40, Cost:0.84253, Acc:0.83594
Test:8, Cost:1.19011, ACC:0.60232
Pass:9, Batch:0, Cost:0.87655, Acc:0.77344
Test:9, Cost:1.18894, ACC:0.59915
Pass:9, Batch:40, Cost:0.88950, Acc:0.74219
Test:9, Cost:1.17149, ACC:0.60451
Pass:10, Batch:0, Cost:0.81905, Acc:0.77344
Test:10, Cost:1.16931, ACC:0.60939
Pass:10, Batch:40, Cost:0.70325, Acc:0.84375
Test:10, Cost:1.15738, ACC:0.61428
Pass:11, Batch:0, Cost:0.71462, Acc:0.81250
Test:11, Cost:1.15619, ACC:0.61525
Pass:11, Batch:40, Cost:0.68220, Acc:0.84375
Test:11, Cost:1.14702, ACC:0.61795
Pass:12, Batch:0, Cost:0.43453, Acc:0.96094
Test:12, Cost:1.14599, ACC:0.61428
Pass:12, Batch:40, Cost:0.66188, Acc:0.84375
Test:12, Cost:1.14097, ACC:0.61697
Pass:13, Batch:0, Cost:0.58125, Acc:0.85156
Test:13, Cost:1.14213, ACC:0.61916
Pass:13, Batch:40, Cost:0.64012, Acc:0.85938
Test:13, Cost:1.13701, ACC:0.62721
Pass:14, Batch:0, Cost:0.63643, Acc:0.82031
Test:14, Cost:1.13649, ACC:0.62697
Pass:14, Batch:40, Cost:0.50114, Acc:0.87500
Test:14, Cost:1.13436, ACC:0.62819
Pass:15, Batch:0, Cost:0.49957, Acc:0.90625
Test:15, Cost:1.13572, ACC:0.63014
Pass:15, Batch:40, Cost:0.47065, Acc:0.85938
Test:15, Cost:1.13555, ACC:0.62990
Pass:16, Batch:0, Cost:0.39780, Acc:0.91406
Test:16, Cost:1.13521, ACC:0.62869
Pass:16, Batch:40, Cost:0.37418, Acc:0.94531
Test:16, Cost:1.13725, ACC:0.63038
Pass:17, Batch:0, Cost:0.42288, Acc:0.92969
Test:17, Cost:1.13657, ACC:0.63038
Pass:17, Batch:40, Cost:0.37270, Acc:0.94531
Test:17, Cost:1.14151, ACC:0.63307
Pass:18, Batch:0, Cost:0.40537, Acc:0.92969
Test:18, Cost:1.13899, ACC:0.63428
Pass:18, Batch:40, Cost:0.33677, Acc:0.94531
Test:18, Cost:1.14520, ACC:0.63502
Pass:19, Batch:0, Cost:0.30855, Acc:0.94531
Test:19, Cost:1.14579, ACC:0.63502
Pass:19, Batch:40, Cost:0.29868, Acc:0.95312
Test:19, Cost:1.15169, ACC:0.63357
Pass:20, Batch:0, Cost:0.43007, Acc:0.89844
Test:20, Cost:1.15162, ACC:0.63381
Pass:20, Batch:40, Cost:0.22576, Acc:0.95312
Test:20, Cost:1.15765, ACC:0.63185
Pass:21, Batch:0, Cost:0.33229, Acc:0.95312
Test:21, Cost:1.15834, ACC:0.63064
Pass:21, Batch:40, Cost:0.25508, Acc:0.94531
Test:21, Cost:1.16431, ACC:0.63040
Pass:22, Batch:0, Cost:0.29368, Acc:0.95312
Test:22, Cost:1.16274, ACC:0.63038
Pass:22, Batch:40, Cost:0.28510, Acc:0.95312
Test:22, Cost:1.17090, ACC:0.62771
Pass:23, Batch:0, Cost:0.30588, Acc:0.93750
Test:23, Cost:1.17182, ACC:0.62795
Pass:23, Batch:40, Cost:0.21246, Acc:0.96094
Test:23, Cost:1.17870, ACC:0.62576
Pass:24, Batch:0, Cost:0.18199, Acc:0.98438
Test:24, Cost:1.18007, ACC:0.62576
Pass:24, Batch:40, Cost:0.23183, Acc:0.96094
Test:24, Cost:1.18755, ACC:0.62674
Pass:25, Batch:0, Cost:0.25291, Acc:0.93750
Test:25, Cost:1.18826, ACC:0.62674
Pass:25, Batch:40, Cost:0.32310, Acc:0.92188
Test:25, Cost:1.19494, ACC:0.62795
Pass:26, Batch:0, Cost:0.19077, Acc:0.96875
Test:26, Cost:1.19636, ACC:0.62576
Pass:26, Batch:40, Cost:0.16953, Acc:0.98438
Test:26, Cost:1.20512, ACC:0.62552
Pass:27, Batch:0, Cost:0.18294, Acc:0.98438
Test:27, Cost:1.20512, ACC:0.62697
Pass:27, Batch:40, Cost:0.24327, Acc:0.95312
Test:27, Cost:1.21305, ACC:0.62697
Pass:28, Batch:0, Cost:0.17915, Acc:0.97656
Test:28, Cost:1.21382, ACC:0.62404
Pass:28, Batch:40, Cost:0.17118, Acc:0.99219
Test:28, Cost:1.22101, ACC:0.62428
Pass:29, Batch:0, Cost:0.17687, Acc:0.96875
Test:29, Cost:1.22168, ACC:0.62209
Pass:29, Batch:40, Cost:0.22348, Acc:0.96875
Test:29, Cost:1.22886, ACC:0.62135
Pass:30, Batch:0, Cost:0.08868, Acc:1.00000
Test:30, Cost:1.22931, ACC:0.62135
Pass:30, Batch:40, Cost:0.21341, Acc:0.96094
Test:30, Cost:1.23766, ACC:0.62014
Pass:31, Batch:0, Cost:0.13895, Acc:0.99219
Test:31, Cost:1.23827, ACC:0.62014
Pass:31, Batch:40, Cost:0.12477, Acc:0.99219
Test:31, Cost:1.24684, ACC:0.62061
Pass:32, Batch:0, Cost:0.12923, Acc:0.99219
Test:32, Cost:1.24785, ACC:0.62014
Pass:32, Batch:40, Cost:0.16307, Acc:0.98438
Test:32, Cost:1.25458, ACC:0.62135
Pass:33, Batch:0, Cost:0.15484, Acc:0.97656
Test:33, Cost:1.25694, ACC:0.62014
Pass:33, Batch:40, Cost:0.17057, Acc:0.96875
Test:33, Cost:1.26460, ACC:0.62185
Pass:34, Batch:0, Cost:0.15017, Acc:0.99219
Test:34, Cost:1.26483, ACC:0.61916
Pass:34, Batch:40, Cost:0.12079, Acc:1.00000
Test:34, Cost:1.27271, ACC:0.61818
Pass:35, Batch:0, Cost:0.14051, Acc:0.99219
Test:35, Cost:1.27131, ACC:0.61866
Pass:35, Batch:40, Cost:0.11580, Acc:0.99219
Test:35, Cost:1.28093, ACC:0.61818
Pass:36, Batch:0, Cost:0.11599, Acc:0.98438
Test:36, Cost:1.28128, ACC:0.61940
Pass:36, Batch:40, Cost:0.12474, Acc:0.98438
Test:36, Cost:1.28900, ACC:0.61916
Pass:37, Batch:0, Cost:0.11079, Acc:0.98438
Test:37, Cost:1.28936, ACC:0.62014
Pass:37, Batch:40, Cost:0.06140, Acc:1.00000
Test:37, Cost:1.29823, ACC:0.61916
Pass:38, Batch:0, Cost:0.09984, Acc:0.98438
Test:38, Cost:1.30005, ACC:0.61966
Pass:38, Batch:40, Cost:0.09596, Acc:0.98438
Test:38, Cost:1.30745, ACC:0.62185
Pass:39, Batch:0, Cost:0.12727, Acc:0.96875
Test:39, Cost:1.30686, ACC:0.62283
Pass:39, Batch:40, Cost:0.12579, Acc:0.99219
Test:39, Cost:1.31494, ACC:0.62088
Pass:40, Batch:0, Cost:0.11683, Acc:0.97656
Test:40, Cost:1.31564, ACC:0.62283
Pass:40, Batch:40, Cost:0.10881, Acc:0.99219
Test:40, Cost:1.32339, ACC:0.62478
Pass:41, Batch:0, Cost:0.17890, Acc:0.96094
Test:41, Cost:1.32331, ACC:0.62478
Pass:41, Batch:40, Cost:0.07103, Acc:1.00000
Test:41, Cost:1.33165, ACC:0.61943
Pass:42, Batch:0, Cost:0.08284, Acc:0.99219
Test:42, Cost:1.33106, ACC:0.61869
Pass:42, Batch:40, Cost:0.09521, Acc:0.97656
Test:42, Cost:1.33917, ACC:0.61700
Pass:43, Batch:0, Cost:0.07278, Acc:0.99219
Test:43, Cost:1.33959, ACC:0.61919
Pass:43, Batch:40, Cost:0.12422, Acc:0.99219
Test:43, Cost:1.34719, ACC:0.62162
Pass:44, Batch:0, Cost:0.08373, Acc:1.00000
Test:44, Cost:1.34702, ACC:0.61895
Pass:44, Batch:40, Cost:0.09269, Acc:0.99219
Test:44, Cost:1.35452, ACC:0.61821
Pass:45, Batch:0, Cost:0.08832, Acc:0.99219
Test:45, Cost:1.35511, ACC:0.61845
Pass:45, Batch:40, Cost:0.08397, Acc:0.99219
Test:45, Cost:1.36335, ACC:0.61895
Pass:46, Batch:0, Cost:0.08041, Acc:0.99219
Test:46, Cost:1.36386, ACC:0.61993
Pass:46, Batch:40, Cost:0.13990, Acc:0.99219
Test:46, Cost:1.37065, ACC:0.62309
Pass:47, Batch:0, Cost:0.08154, Acc:0.99219
Test:47, Cost:1.37091, ACC:0.62212
Pass:47, Batch:40, Cost:0.08119, Acc:0.98438
Test:47, Cost:1.37767, ACC:0.62333
Pass:48, Batch:0, Cost:0.09884, Acc:0.98438
Test:48, Cost:1.37948, ACC:0.62407
Pass:48, Batch:40, Cost:0.06289, Acc:0.99219
Test:48, Cost:1.38637, ACC:0.62090
Pass:49, Batch:0, Cost:0.10498, Acc:0.98438
Test:49, Cost:1.38653, ACC:0.62090
Pass:49, Batch:40, Cost:0.04686, Acc:1.00000
Test:49, Cost:1.39335, ACC:0.62090
```

预测迭代输出（部分）：

```verilog
预测结果标签为：3， 名称为：3， 概率为：0.999515
预测结果标签为：8， 名称为：8， 概率为：0.999912
预测结果标签为：3， 名称为：3， 概率为：0.999656
预测结果标签为：5， 名称为：5， 概率为：0.999305
预测结果标签为：3， 名称为：3， 概率为：0.999532
预测结果标签为：9， 名称为：9， 概率为：0.999810
预测结果标签为：9， 名称为：9， 概率为：0.993418
预测结果标签为：9， 名称为：9， 概率为：0.999761
预测结果标签为：8， 名称为：8， 概率为：0.999687
预测结果标签为：1， 名称为：1， 概率为：0.995791
预测结果标签为：8， 名称为：8， 概率为：0.999731
预测结果标签为：5， 名称为：5， 概率为：0.995905
预测结果标签为：5， 名称为：5， 概率为：0.997542
预测结果标签为：9， 名称为：9， 概率为：0.999930
预测结果标签为：2， 名称为：2， 概率为：0.998152
预测结果标签为：9， 名称为：9， 概率为：0.999630
预测结果标签为：5， 名称为：5， 概率为：0.999668
预测结果标签为：5， 名称为：5， 概率为：0.999181
预测结果标签为：8， 名称为：8， 概率为：0.999770
预测结果标签为：9， 名称为：9， 概率为：0.998988
预测结果标签为：9， 名称为：9， 概率为：0.999110
预测结果标签为：3， 名称为：3， 概率为：0.999672
预测结果标签为：3， 名称为：3， 概率为：0.999675
预测结果标签为：1， 名称为：1， 概率为：0.998720
预测结果标签为：3， 名称为：3， 概率为：0.999505
预测结果标签为：9， 名称为：9， 概率为：0.999588
预测结果标签为：6， 名称为：6， 概率为：0.997391
预测结果标签为：8， 名称为：8， 概率为：0.999876
预测结果标签为：3， 名称为：3， 概率为：0.999593
预测结果标签为：9， 名称为：9， 概率为：0.999807
预测结果标签为：5， 名称为：5， 概率为：0.998808
预测结果标签为：9， 名称为：9， 概率为：0.999785
预测结果标签为：9， 名称为：9， 概率为：0.999509
预测结果标签为：6， 名称为：6， 概率为：0.999769
预测结果标签为：9， 名称为：9， 概率为：0.999905
预测结果标签为：9， 名称为：9， 概率为：0.991497
预测结果标签为：9， 名称为：9， 概率为：0.998278
预测结果标签为：8， 名称为：8， 概率为：0.999672
预测结果标签为：3， 名称为：3， 概率为：0.999713
预测结果标签为：9， 名称为：9， 概率为：0.999951
预测结果标签为：6， 名称为：6， 概率为：0.996646
预测结果标签为：6， 名称为：6， 概率为：0.998817
预测结果标签为：5， 名称为：5， 概率为：0.999460
预测结果标签为：8， 名称为：8， 概率为：0.999365
预测结果标签为：9， 名称为：9， 概率为：0.999858
预测结果标签为：2， 名称为：2， 概率为：0.999043
预测结果标签为：3， 名称为：3， 概率为：0.999792
预测结果标签为：3， 名称为：3， 概率为：0.999733
预测结果标签为：3， 名称为：3， 概率为：0.999399
预测结果标签为：5， 名称为：5， 概率为：0.999431
预测结果标签为：3， 名称为：3， 概率为：0.999643
预测结果标签为：9， 名称为：9， 概率为：0.999906
预测结果标签为：6， 名称为：6， 概率为：0.999160
预测结果标签为：2， 名称为：2， 概率为：0.999324
预测结果标签为：9， 名称为：9， 概率为：0.978567
预测结果标签为：4， 名称为：4， 概率为：0.998770
预测结果标签为：0， 名称为：0， 概率为：0.997624
预测结果标签为：9， 名称为：9， 概率为：0.997769
预测结果标签为：5， 名称为：5， 概率为：0.999236
预测结果标签为：3， 名称为：3， 概率为：0.999817
预测结果标签为：5， 名称为：5， 概率为：0.999514
预测结果标签为：8， 名称为：8， 概率为：0.999878
预测结果标签为：9， 名称为：9， 概率为：0.998768
预测结果标签为：3， 名称为：3， 概率为：0.999802
预测结果标签为：9， 名称为：9， 概率为：0.998377
预测结果标签为：3， 名称为：3， 概率为：0.999237
预测结果标签为：5， 名称为：5， 概率为：0.999429
预测结果标签为：9， 名称为：9， 概率为：0.999898
预测结果标签为：5， 名称为：5， 概率为：0.998298
预测结果标签为：6， 名称为：6， 概率为：0.999803
预测结果标签为：3， 名称为：3， 概率为：0.996960
预测结果标签为：8， 名称为：8， 概率为：0.998771
预测结果标签为：9， 名称为：9， 概率为：0.996913
预测结果标签为：6， 名称为：6， 概率为：0.998757
预测结果标签为：5， 名称为：5， 概率为：0.998895
预测结果标签为：5， 名称为：5， 概率为：0.999455
预测结果标签为：2， 名称为：2， 概率为：0.999650
预测结果标签为：8， 名称为：8， 概率为：0.999794
预测结果标签为：3， 名称为：3， 概率为：0.995986
预测结果标签为：8， 名称为：8， 概率为：0.999147
预测结果标签为：8， 名称为：8， 概率为：0.999860
预测结果标签为：5， 名称为：5， 概率为：0.996264
预测结果标签为：5， 名称为：5， 概率为：0.999606
预测结果标签为：3， 名称为：3， 概率为：0.998942
预测结果标签为：6， 名称为：6， 概率为：0.999875
预测结果标签为：3， 名称为：3， 概率为：0.999697
预测结果标签为：9， 名称为：9， 概率为：0.999521
预测结果标签为：3， 名称为：3， 概率为：0.999732
预测结果标签为：8， 名称为：8， 概率为：0.999578
预测结果标签为：3， 名称为：3， 概率为：0.999835
预测结果标签为：3， 名称为：3， 概率为：0.999905
预测结果标签为：9， 名称为：9， 概率为：0.999938
预测结果标签为：4， 名称为：4， 概率为：0.999320
预测结果标签为：0， 名称为：0， 概率为：0.967843
预测结果标签为：5， 名称为：5， 概率为：0.999354
预测结果标签为：8， 名称为：8， 概率为：0.999859
预测结果标签为：3， 名称为：3， 概率为：0.999808
预测结果标签为：9， 名称为：9， 概率为：0.999706
预测结果标签为：9， 名称为：9， 概率为：0.999841
预测结果标签为：3， 名称为：3， 概率为：0.999711
预测结果标签为：8， 名称为：8， 概率为：0.999848
预测结果标签为：3， 名称为：3， 概率为：0.999552
预测结果标签为：3， 名称为：3， 概率为：0.999582
预测结果标签为：6， 名称为：6， 概率为：0.999731
预测结果标签为：3， 名称为：3， 概率为：0.999796
预测结果标签为：8， 名称为：8， 概率为：0.999836
预测结果标签为：3， 名称为：3， 概率为：0.999681
预测结果标签为：9， 名称为：9， 概率为：0.999633
预测结果标签为：8， 名称为：8， 概率为：0.999442
预测结果标签为：3， 名称为：3， 概率为：0.999427
预测结果标签为：5， 名称为：5， 概率为：0.999276
预测结果标签为：4， 名称为：4， 概率为：0.999500
预测结果标签为：5， 名称为：5， 概率为：0.999688
预测结果标签为：8， 名称为：8， 概率为：0.999826
预测结果标签为：6， 名称为：6， 概率为：0.999643
预测结果标签为：8， 名称为：8， 概率为：0.997779
预测结果标签为：3， 名称为：3， 概率为：0.998990
预测结果标签为：9， 名称为：9， 概率为：0.999868
预测结果标签为：9， 名称为：9， 概率为：0.684625
预测结果标签为：3， 名称为：3， 概率为：0.999650
预测结果标签为：2， 名称为：2， 概率为：0.999265
预测结果标签为：9， 名称为：9， 概率为：0.999849
预测结果标签为：8， 名称为：8， 概率为：0.999760
预测结果标签为：9， 名称为：9， 概率为：0.999800
预测结果标签为：6， 名称为：6， 概率为：0.999826
预测结果标签为：3， 名称为：3， 概率为：0.999832
预测结果标签为：5， 名称为：5， 概率为：0.997896
预测结果标签为：5， 名称为：5， 概率为：0.998601
预测结果标签为：8， 名称为：8， 概率为：0.999821
预测结果标签为：6， 名称为：6， 概率为：0.999287
预测结果标签为：5， 名称为：5， 概率为：0.998484
the accurary is :0.981
```

### 模型：infer_model1

训练输出：迭代次数20

```verilog
运行输出
运行耗时: 13秒817毫秒
Pass:0, Batch:0, Cost:2.31272, Acc:0.03125
Test:0, Cost:2.24595, ACC:0.19969
Pass:1, Batch:0, Cost:1.81745, Acc:0.45312
Test:1, Cost:1.84772, ACC:0.38608
Pass:2, Batch:0, Cost:1.41308, Acc:0.64844
Test:2, Cost:1.53850, ACC:0.51381
Pass:3, Batch:0, Cost:1.25036, Acc:0.65234
Test:3, Cost:1.34495, ACC:0.55994
Pass:4, Batch:0, Cost:0.88966, Acc:0.80078
Test:4, Cost:1.23029, ACC:0.59277
Pass:5, Batch:0, Cost:0.88889, Acc:0.76562
Test:5, Cost:1.16325, ACC:0.61055
Pass:6, Batch:0, Cost:0.71513, Acc:0.83984
Test:6, Cost:1.12812, ACC:0.61564
Pass:7, Batch:0, Cost:0.69282, Acc:0.83203
Test:7, Cost:1.10100, ACC:0.63450
Pass:8, Batch:0, Cost:0.56466, Acc:0.85156
Test:8, Cost:1.08364, ACC:0.63665
Pass:9, Batch:0, Cost:0.54750, Acc:0.85938
Test:9, Cost:1.07774, ACC:0.63615
Pass:10, Batch:0, Cost:0.47748, Acc:0.91016
Test:10, Cost:1.08290, ACC:0.64241
Pass:11, Batch:0, Cost:0.43657, Acc:0.89844
Test:11, Cost:1.08662, ACC:0.64046
Pass:12, Batch:0, Cost:0.34100, Acc:0.92578
Test:12, Cost:1.09085, ACC:0.63871
Pass:13, Batch:0, Cost:0.32262, Acc:0.92188
Test:13, Cost:1.10559, ACC:0.63860
Pass:14, Batch:0, Cost:0.29162, Acc:0.94922
Test:14, Cost:1.11402, ACC:0.64595
Pass:15, Batch:0, Cost:0.25937, Acc:0.96094
Test:15, Cost:1.12722, ACC:0.64564
Pass:16, Batch:0, Cost:0.21458, Acc:0.96094
Test:16, Cost:1.13567, ACC:0.64487
Pass:17, Batch:0, Cost:0.21839, Acc:0.97266
Test:17, Cost:1.15285, ACC:0.64271
Pass:18, Batch:0, Cost:0.16948, Acc:0.96875
Test:18, Cost:1.16557, ACC:0.64477
Pass:19, Batch:0, Cost:0.18152, Acc:0.96094
Test:19, Cost:1.17665, ACC:0.64682
```

部分少量预测结果日志

```verilog
运行输出
运行耗时: 32秒806毫秒
预测结果标签为：9， 名称为：9， 概率为：0.998335
预测结果标签为：8， 名称为：8， 概率为：0.997243
预测结果标签为：1， 名称为：1， 概率为：0.974011
预测结果标签为：8， 名称为：8， 概率为：0.997754
预测结果标签为：9， 名称为：9， 概率为：0.938332
预测结果标签为：8， 名称为：8， 概率为：0.992840
预测结果标签为：9， 名称为：9， 概率为：0.906592
预测结果标签为：5， 名称为：5， 概率为：0.998645
预测结果标签为：9， 名称为：9， 概率为：0.995915
预测结果标签为：3， 名称为：3， 概率为：0.893067
预测结果标签为：9， 名称为：9， 概率为：0.999800
预测结果标签为：5， 名称为：5， 概率为：0.999970
预测结果标签为：5， 名称为：5， 概率为：0.999953
预测结果标签为：3， 名称为：3， 概率为：0.949420
预测结果标签为：4， 名称为：4， 概率为：0.975957
预测结果标签为：5， 名称为：5， 概率为：0.999858
预测结果标签为：5， 名称为：5， 概率为：0.948048
预测结果标签为：9， 名称为：9， 概率为：0.991910
预测结果标签为：1， 名称为：1， 概率为：0.978594
预测结果标签为：9， 名称为：9， 概率为：0.996044
预测结果标签为：8， 名称为：8， 概率为：0.935919
预测结果标签为：9， 名称为：9， 概率为：0.804322
预测结果标签为：6， 名称为：6， 概率为：0.978003
预测结果标签为：5， 名称为：5， 概率为：0.996343
预测结果标签为：6， 名称为：6， 概率为：0.941220
预测结果标签为：5， 名称为：5， 概率为：0.897283
预测结果标签为：3， 名称为：3， 概率为：0.852642
预测结果标签为：3， 名称为：3， 概率为：0.999675
预测结果标签为：3， 名称为：3， 概率为：0.966107
预测结果标签为：6， 名称为：6， 概率为：0.987612
预测结果标签为：8， 名称为：8， 概率为：0.999760
预测结果标签为：3， 名称为：3， 概率为：0.981871
预测结果标签为：3， 名称为：3， 概率为：0.972782
预测结果标签为：3， 名称为：3， 概率为：0.809394
预测结果标签为：1， 名称为：1， 概率为：0.965925
预测结果标签为：3， 名称为：3， 概率为：0.996171
预测结果标签为：3， 名称为：3， 概率为：0.992061
预测结果标签为：4， 名称为：4， 概率为：0.764386
预测结果标签为：0， 名称为：0， 概率为：0.355728
预测结果标签为：5， 名称为：5， 概率为：0.933631
预测结果标签为：8， 名称为：8， 概率为：0.465576
预测结果标签为：1， 名称为：1， 概率为：0.964662
预测结果标签为：3， 名称为：3， 概率为：0.974428
预测结果标签为：4， 名称为：4， 概率为：0.695865
预测结果标签为：2， 名称为：2， 概率为：0.976151
预测结果标签为：2， 名称为：2， 概率为：0.705707
预测结果标签为：8， 名称为：8， 概率为：0.865111
预测结果标签为：1， 名称为：1， 概率为：0.805396
预测结果标签为：3， 名称为：3， 概率为：0.966817
预测结果标签为：9， 名称为：9， 概率为：0.933152
预测结果标签为：9， 名称为：9， 概率为：0.999612
预测结果标签为：9， 名称为：9， 概率为：0.947917
预测结果标签为：5， 名称为：5， 概率为：0.997199
预测结果标签为：8， 名称为：8， 概率为：0.786440
预测结果标签为：8， 名称为：8， 概率为：0.974956
预测结果标签为：6， 名称为：6， 概率为：0.999848
预测结果标签为：8， 名称为：8， 概率为：0.999662
预测结果标签为：9， 名称为：9， 概率为：0.937772
预测结果标签为：3， 名称为：3， 概率为：0.983039
预测结果标签为：8， 名称为：8， 概率为：0.991293
预测结果标签为：8， 名称为：8， 概率为：0.983372
预测结果标签为：5， 名称为：5， 概率为：0.994179
预测结果标签为：4， 名称为：4， 概率为：0.974319
预测结果标签为：3， 名称为：3， 概率为：0.999181
预测结果标签为：5， 名称为：5， 概率为：0.999173
预测结果标签为：3， 名称为：3， 概率为：0.903661
预测结果标签为：8， 名称为：8， 概率为：0.969651
预测结果标签为：9， 名称为：9， 概率为：0.982604
预测结果标签为：9， 名称为：9， 概率为：0.997458
预测结果标签为：6， 名称为：6， 概率为：0.967349
预测结果标签为：9， 名称为：9， 概率为：0.981157
预测结果标签为：8， 名称为：8， 概率为：0.985195
预测结果标签为：6， 名称为：6， 概率为：0.877553
预测结果标签为：9， 名称为：9， 概率为：0.795158
预测结果标签为：5， 名称为：5， 概率为：0.991092
预测结果标签为：1， 名称为：1， 概率为：0.993570
预测结果标签为：1， 名称为：1， 概率为：0.947808
预测结果标签为：5， 名称为：5， 概率为：0.710040
预测结果标签为：3， 名称为：3， 概率为：0.986249
预测结果标签为：6， 名称为：6， 概率为：0.678286
预测结果标签为：1， 名称为：1， 概率为：0.964892
预测结果标签为：8， 名称为：8， 概率为：0.897875
预测结果标签为：0， 名称为：0， 概率为：0.568190
预测结果标签为：5， 名称为：5， 概率为：0.952567
预测结果标签为：3， 名称为：3， 概率为：0.851061
预测结果标签为：3， 名称为：3， 概率为：0.954985
预测结果标签为：2， 名称为：2， 概率为：0.606989
预测结果标签为：2， 名称为：2， 概率为：0.671729
预测结果标签为：4， 名称为：4， 概率为：0.995273
预测结果标签为：4， 名称为：4， 概率为：0.986422
预测结果标签为：4， 名称为：4， 概率为：0.966105
预测结果标签为：3， 名称为：3， 概率为：0.717699
预测结果标签为：5， 名称为：5， 概率为：0.894837
预测结果标签为：9， 名称为：9， 概率为：0.970747
预测结果标签为：2， 名称为：2， 概率为：0.950979
预测结果标签为：3， 名称为：3， 概率为：0.891249
the accurary is :0.984
```

### 预测图片

![](.\img\输出结果图.png)

## 7.链接

github仓库：<https://github.com/guanjiangtao/python_work/tree/master/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1>

百度平台地址（已经公开）：<https://aistudio.baidu.com/aistudio/projectdetail/71554>

paddlepaddle安装文档：<http://paddlepaddle.org/documentation/docs/zh/1.4/beginners_guide/install/index_cn.html?from=paddlefooter>

对应代码git地址：<https://github.com/guanjiangtao/cnn_text_classification>   （请使用GPU进行运算）

